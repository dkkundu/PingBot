<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ title if title else "Dashboard" }}</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
<style>
[x-cloak]{ display:none !important; }
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}
</style>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<style>
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-thumb { background-color: #555; border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background-color: #333; }
</style>
</head>
<body class="bg-gray-100 font-sans">

<!-- Sidebar -->
<div class="flex h-screen">
<aside class="w-64 bg-[#1E3A8A] text-white flex flex-col shadow-lg">
<div class="flex items-center p-4 text-2xl font-bold border-b border-[#2563EB] tracking-wide text-white">
  <!-- Icon: modern circle + wave/ping -->
  <div class="relative mr-3">
    <div class="w-10 h-10 rounded-full bg-gradient-to-tr from-[#22D3EE] to-[#3B82F6] flex items-center justify-center">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m-3-3l-3 3m3-3a9 9 0 110-12 9 9 0 010 12z" />
      </svg>
    </div>
  </div>

  PingBot
</div>

  <nav class="flex-1 overflow-y-auto mt-6">
    <ul class="space-y-2">

      <!-- Dashboard -->
      <li>
        <a href="{{ url_for('frontend.dashboard') }}"
           class="flex items-center px-6 py-3 rounded-lg hover:bg-[#2563EB] transition-colors duration-200
           {% if request.endpoint == 'frontend.dashboard' %} bg-[#2563EB] border-l-4 border-[#22D3EE] {% endif %}">
          <i class="fas fa-tachometer-alt w-5"></i>
          <span class="ml-3 font-medium">Dashboard</span>
        </a>
      </li>
      


      <!-- Admin only -->
      {% if current_user.role == 'admin' or current_user.is_superuser %}
      <li>
        <a href="{{ url_for('frontend.pending_users') }}"
           class="flex items-center px-6 py-3 rounded-lg hover:bg-[#2563EB] transition-colors duration-200
           {% if request.endpoint == 'frontend.pending_users' %} bg-[#2563EB] border-l-4 border-[#22D3EE] {% endif %}">
          <i class="fas fa-user-clock w-5"></i>
          <span class="ml-3 font-medium">Pending Users</span>
        </a>
      </li>
     
      {% endif %}


          <!--  User -->

                <li>
                  <a href="{{ url_for('frontend.approved_users') }}"
                    class="flex items-center px-6 py-3 rounded-lg hover:bg-[#2563EB] transition-colors duration-200
                    {% if request.endpoint == 'frontend.approved_users' %} bg-[#2563EB] border-l-4 border-[#22D3EE] {% endif %}">
                    <i class="fas fa-users w-5"></i>
                    <span class="ml-3 font-medium">Users</span>
                  </a>
                </li>
<!-- Alerts Section -->
<!-- Alert Dropdown -->
<!-- Alert Dropdown -->
<li 
  x-data="{ 
    alertOpen: JSON.parse(localStorage.getItem('alertOpen') || 'false'),
    toggle() {
      this.alertOpen = !this.alertOpen;
      localStorage.setItem('alertOpen', this.alertOpen);
    }
  }" 
  class="relative"
>
  <!-- Button -->
  <button
    @click="toggle()"
    :aria-expanded="alertOpen.toString()"
    class="flex items-center justify-between w-full px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors duration-200"
  >
    <div class="flex items-center space-x-3">
      <i class="fas fa-bell text-white w-5"></i>
      <span class="font-medium text-white">Alert</span>
    </div>

    <i
      class="transition-transform duration-300 text-white fas"
      :class="alertOpen ? 'fa-chevron-up rotate-180' : 'fa-chevron-down'"
    ></i>
  </button>

  <!-- Dropdown Menu -->
  <ul
    x-cloak
    x-show="alertOpen"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 max-h-0"
    x-transition:enter-end="opacity-100 max-h-64"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100 max-h-64"
    x-transition:leave-end="opacity-0 max-h-0"
    class="overflow-hidden mt-2 space-y-1 bg-blue-700 rounded-lg shadow-lg pl-6 py-2"
  >


    <li>
      <a href="{{ url_for('alert.list_samples') }}"
         class="flex items-center px-4 py-2 rounded-lg hover:bg-blue-500 transition-colors duration-200
         {% if request.endpoint == 'alert.list_samples' %} bg-blue-500 border-l-4 border-cyan-400 {% endif %}">
        <i class="fas fa-bell w-5 text-white"></i>
        <span class="ml-3 font-medium text-white">Message</span>
      </a>
    </li>

    <li>
      <a href="{{ url_for('alert.list_configs') }}"
         class="flex items-center px-4 py-2 rounded-lg hover:bg-blue-500 transition-colors duration-200
         {% if request.endpoint == 'alert.list_configs' %} bg-blue-500 border-l-4 border-cyan-400 {% endif %}">
        <i class="fas fa-cogs w-5 text-white"></i>
        <span class="ml-3 font-medium text-white">Config</span>
      </a>
    </li>

    <li>
      <a href="{{ url_for('alert.list_services') }}"
         class="flex items-center px-4 py-2 rounded-lg hover:bg-blue-500 transition-colors duration-200
         {% if request.endpoint == 'alert.list_services' %} bg-blue-500 border-l-4 border-cyan-400 {% endif %}">
        <i class="fas fa-server w-5 text-white"></i>
        <span class="ml-3 font-medium text-white">Service</span>
      </a>
    </li>
      <li>
      <a href="{{ url_for('alert.list_logs') }}"
         class="flex items-center px-4 py-2 rounded-lg hover:bg-blue-500 transition-colors duration-200
         {% if request.endpoint == 'alert.list_logs' %} bg-blue-500 border-l-4 border-cyan-400 {% endif %}">
        <i class="fas fa-clipboard-list w-5 text-white"></i>
        <span class="ml-3 font-medium text-white">Logs</span>
      </a>
    </li>
    <li>
      <a href="{{ url_for('alert.list_test_credentials') }}"
         class="flex items-center px-4 py-2 rounded-lg hover:bg-blue-500 transition-colors duration-200
         {% if request.endpoint == 'alert.list_test_credentials' %} bg-blue-500 border-l-4 border-cyan-400 {% endif %}">
        <i class="fas fa-flask w-5 text-white"></i>
        <span class="ml-3 font-medium text-white">Test Config</span>
      </a>
    </li>
  </ul>
</li>




    </ul>
  </nav>
</aside>



  <!-- Main content -->
  <div class="flex-1 flex flex-col">
 <!-- Top navbar -->
<header class="bg-white shadow p-4 flex justify-between items-center">
  <h1 class="text-2xl font-semibold text-gray-800">
    {{ title if title else "SSL WIRELESS" }}
  </h1>

  <!-- User Dropdown -->
  <div class="relative">
    <button id="user-menu-button" 
            class="flex items-center gap-3 focus:outline-none group">
      
      {% if current_user.profile_pic %}
      <img src="{{ url_for('uploaded_file', filename=current_user.profile_pic.split('media/uploads/')[-1]) }}" 
           alt="Profile Picture" 
           class="w-10 h-10 rounded-full object-cover border">
      {% else %}
      <div class="w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center text-gray-700 font-bold">
        {{ current_user.full_name[0] }}
      </div>
      {% endif %}
      
      <span class="font-medium text-gray-800">{{ current_user.full_name }}</span>
      
      <!-- Dropdown Icon -->
      <svg class="w-4 h-4 text-gray-500 group-hover:text-gray-700 transition" 
           fill="none" stroke="currentColor" stroke-width="2" 
           viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" 
              d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <!-- Dropdown Menu -->
    <div id="user-dropdown" 
         class="hidden absolute right-0 mt-3 w-48 bg-white rounded-xl shadow-lg border border-gray-100 py-2 z-50">

       <!-- Profile -->
      <a href="{{ url_for('frontend.profile') }}" 
         class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-50 hover:text-indigo-600 transition">
         <i class="fas fa-user w-5"></i>
        <span><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">Profile</span>
      </a>


      <!-- Edit Profile -->
      <a href="{{ url_for('frontend.edit_profile') }}" 
         class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-50 hover:text-indigo-600 transition">
        <i class="bi bi-pencil-square text-indigo-500"></i>
        <span><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">Edit Profile</span>
      </a>

   
      <!--password change-->
       <a href="{{ url_for('frontend.change_password') }}" 
         class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-50 hover:text-red-600 transition">
        <i class="bi bi-lock"></i>
        <span>Change Password</span>
      </a>
         <!-- Logout -->
      <a href="{{ url_for('frontend.logout') }}" 
         class="flex items-center gap-3 px-4 py-2 text-gray-700 hover:bg-gray-50 hover:text-red-600 transition">
        <i class="bi bi-box-arrow-right text-red-500"></i>
        <span>Logout</span>
      </a>
    </div>
  </div>
</header>

    
    

    <!-- Page content -->
    <main class="flex-1 p-4 overflow-y-auto min-w-0">
      {% block content %}{% endblock %}
    </main>
  </div>
</div>
</body>
<!-- Script to toggle dropdown -->
<script>
  const userMenuButton = document.getElementById('user-menu-button');
  const userDropdown = document.getElementById('user-dropdown');

  userMenuButton.addEventListener('click', () => {
    userDropdown.classList.toggle('hidden');
  });

  // Optional: close dropdown when clicking outside
  document.addEventListener('click', (event) => {
    if (!userMenuButton.contains(event.target) && !userDropdown.contains(event.target)) {
      userDropdown.classList.add('hidden');
    }
  });
</script>
<script>
  const alertsBtn = document.getElementById('alerts-btn');
  const alertsDropdown = document.getElementById('alerts-dropdown');

  alertsBtn.addEventListener('click', () => {
    alertsDropdown.classList.toggle('hidden');
    // Toggle arrow rotation
    const arrow = alertsBtn.querySelector('svg');
    arrow.classList.toggle('rotate-180');
  });
</script>


<!-- Make sure to include Alpine.js for x-data/x-show -->
<script src="//unpkg.com/alpinejs" defer></script>
</html>
